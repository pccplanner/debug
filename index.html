<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Script Manager Tool</title>
<style>
  body {
    margin:0;
    padding:16px;
    background:#0d1117;
    color:#c9d1d9;
    font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
    display:flex; flex-direction:column; height:100vh;
  }
  h1 { text-align:center; margin-bottom:12px; font-size:20px; }
  .top-bar {
    display:flex; flex-wrap:wrap; gap:8px;
    align-items:center; margin-bottom:8px;
  }
  label { font-size:14px; }
  input[type=file] {
    height:32px; border-radius:16px; padding:0 12px;
    background:#fff; color:#000; border:none;
  }
  .actions {
    display:flex; flex-wrap:wrap; gap:8px; margin-left:auto;
  }
  .actions button {
    height:32px; padding:0 12px;
    border:none; border-radius:16px;
    background:#238636; color:#fff;
    font-size:14px; flex:1 1 100px;
  }
  .actions button:hover { background:#2ea44f }
  .code-container {
    display:flex; flex:1; gap:8px; overflow:hidden;
  }
  .panel {
    flex:1; display:flex; background:#21262d;
    border:1px solid #30363d; border-radius:6px;
    overflow:hidden;
  }
  .line-numbers {
    width:40px; background:#161b22; padding:10px 5px;
    text-align:right; font-family:SFMono-Regular,monospace;
    font-size:12px; color:#8b949e; overflow:auto;
    border-right:1px solid #30363d;
  }
  textarea {
    flex:1; border:none; padding:10px;
    background:#21262d; color:#c9d1d9;
    font-family:SFMono-Regular,monospace;
    font-size:14px; line-height:1.5;
    resize:none; overflow:auto;
  }
</style>
</head>
<body>
  <h1>Script Manager Tool</h1>

  <div class="top-bar">
    <label>Load Original:</label>
    <input type="file" id="file-original" accept=".txt" onchange="loadFile('original')">
    <label>Load Patch:</label>
    <input type="file" id="file-patch" accept=".txt" onchange="loadFile('patch')">
    <div class="actions">
      <button onclick="compareScripts()">Compare</button>
      <button onclick="applyPatch()">Apply Patch</button>
      <button onclick="mergeScripts()">Merge</button>
      <button onclick="clearContent()">Clear</button>
      <button onclick="saveProject()">Save</button>
    </div>
  </div>

  <div class="code-container">
    <div class="panel" id="orig-panel">
      <div class="line-numbers" id="orig-lines"></div>
      <textarea id="original" placeholder="Original script…" oninput="updateLines('original')"></textarea>
    </div>
    <div class="panel" id="patch-panel">
      <div class="line-numbers" id="patch-lines"></div>
      <textarea id="patch" placeholder="Patch script…" oninput="updateLines('patch')"></textarea>
    </div>
  </div>

<script>
function loadFile(panel) {
  const input=document.getElementById(`file-${panel}`);
  const reader=new FileReader();
  reader.onload=e=>{
    document.getElementById(panel).value=e.target.result;
    updateLines(panel);
    localStorage.setItem(panel+'Script',e.target.result);
  };
  reader.readAsText(input.files[0]);
}

function updateLines(id) {
  const ta=document.getElementById(id);
  const lines=ta.value.split('\n').length;
  const container=document.getElementById(id+'-lines');
  container.innerHTML=Array.from({length:lines},(_,i)=>i+1).join('\n');
}

function compareScripts(){
  const orig=document.getElementById('original').value.split('\n');
  const patch=document.getElementById('patch').value.split('\n');
  let out='';
  for(let i=0;i<Math.max(orig.length,patch.length);i++){
    if(orig[i]===patch[i]) out+=`${orig[i]||''}\n`;
    else{
      if(orig[i]) out+=`<span class="removed">- ${orig[i]}</span>\n`;
      if(patch[i]) out+=`<span class="highlight">+ ${patch[i]}</span>\n`;
    }
  }
  document.getElementById('original').value=out;
  updateLines('original');
  const firstChange=document.querySelector('.highlight, .removed');
  if(firstChange) firstChange.scrollIntoView({behavior:'smooth',block:'center'});
}

function applyPatch(){alert('Not implemented');}
function mergeScripts(){alert('Not implemented');}
function clearContent(){
  ['original','patch'].forEach(id=>{
    document.getElementById(id).value='';
    document.getElementById(id+'-lines').innerHTML='';
  });
}
function saveProject(){
  localStorage.setItem('originalScript',document.getElementById('original').value);
  localStorage.setItem('patchScript',document.getElementById('patch').value);
  alert('Saved');
}

window.onload=()=>{
  ['original','patch'].forEach(id=>{
    const txt=localStorage.getItem(id+'Script');
    if(txt){ document.getElementById(id).value=txt; updateLines(id);}
  });
};
</script>
</body>
</html>